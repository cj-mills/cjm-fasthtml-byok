# Beforeware


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Beforeware Functions

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L18"
target="_blank" style="float:right; font-size:smaller">source</a>

### create_byok_beforeware

>  create_byok_beforeware
>                              (byok_manager:cjm_fasthtml_byok.core.storage.BYOK
>                              Manager)

*Create a FastHTML beforeware handler for BYOK functionality.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>byok_manager</td>
<td>BYOKManager</td>
<td>The BYOK manager instance</td>
</tr>
</tbody>
</table>

## Route Decorators

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L36"
target="_blank" style="float:right; font-size:smaller">source</a>

### require_api_key

>  require_api_key (provider:str, user_id_func:Optional[Callable]=None)

*Decorator that requires an API key to be present for a route.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>provider</td>
<td>str</td>
<td></td>
<td>The provider name to check for</td>
</tr>
<tr>
<td>user_id_func</td>
<td>Optional</td>
<td>None</td>
<td>Optional function to get user_id from request Usage: <span
class="citation" data-cites="rt">@rt</span> <span class="citation"
data-cites="require_api_key">@require_api_key</span>(“openai”) def
chat(request): byok = request.scope[‘byok’] api_key =
byok.get_key(request, “openai”) # Use the API key…</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L73"
target="_blank" style="float:right; font-size:smaller">source</a>

### require_any_api_key

>  require_any_api_key (providers:List[str],
>                           user_id_func:Optional[Callable]=None)

*Decorator that requires at least one of the specified API keys.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>providers</td>
<td>List</td>
<td></td>
<td>List of provider names to check</td>
</tr>
<tr>
<td>user_id_func</td>
<td>Optional</td>
<td>None</td>
<td>Optional function to get user_id from request Usage: <span
class="citation" data-cites="rt">@rt</span> <span class="citation"
data-cites="require_any_api_key">@require_any_api_key</span>([“openai”,
“anthropic”, “google”]) def chat(request): # Use whichever API key is
available pass</td>
</tr>
</tbody>
</table>

## Security Beforeware

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L117"
target="_blank" style="float:right; font-size:smaller">source</a>

### SecurityCheckBeforeware

>  SecurityCheckBeforeware (require_https:bool=True,
>                               is_production:Optional[bool]=None)

*Beforeware that performs security checks.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>require_https</td>
<td>bool</td>
<td>True</td>
<td>Whether to require HTTPS in production</td>
</tr>
<tr>
<td>is_production</td>
<td>Optional</td>
<td>None</td>
<td>Whether running in production (auto-detected if None)</td>
</tr>
</tbody>
</table>

## Cleanup Beforeware

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L152"
target="_blank" style="float:right; font-size:smaller">source</a>

### CleanupBeforeware

>  CleanupBeforeware
>                         (byok_manager:cjm_fasthtml_byok.core.storage.BYOKManag
>                         er, user_id_func:Optional[Callable]=None)

*Beforeware that cleans up expired keys.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>byok_manager</td>
<td>BYOKManager</td>
<td></td>
<td>The BYOK manager instance</td>
</tr>
<tr>
<td>user_id_func</td>
<td>Optional</td>
<td>None</td>
<td>Optional function to get user_id from request</td>
</tr>
</tbody>
</table>

## Complete Setup Helper

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-byok/blob/main/cjm_fasthtml_byok/middleware/beforeware.py#L189"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_byok

>  setup_byok (secret_key:str, db:Optional[Any]=None,
>                  user_id_func:Optional[Callable]=None,
>                  enable_security_checks:bool=True, enable_cleanup:bool=True)

*Complete setup helper for BYOK with FastHTML. Returns beforeware
functions and the BYOK manager.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>secret_key</td>
<td>str</td>
<td></td>
<td>Application secret key</td>
</tr>
<tr>
<td>db</td>
<td>Optional</td>
<td>None</td>
<td>Optional database for persistent storage</td>
</tr>
<tr>
<td>user_id_func</td>
<td>Optional</td>
<td>None</td>
<td>Optional function to get user_id from request</td>
</tr>
<tr>
<td>enable_security_checks</td>
<td>bool</td>
<td>True</td>
<td>Enable HTTPS checking</td>
</tr>
<tr>
<td>enable_cleanup</td>
<td>bool</td>
<td>True</td>
<td>Enable automatic cleanup of expired keys</td>
</tr>
</tbody>
</table>
